"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[929],{49612:function(Yr,I,B){var Ie,Te=B(41588).default,Ce=B(73808).default,Ke=B(19159).default,ve=B(65661).default,it=B(50468).default,nt=B(66115).default,W=B(61655).default,G=B(26389).default,Xe=B(71860).default,Ze=B(38416).default,Fe=B(54467).default,Ht=B(27424).default,jt=B(74704).default,lt=B(17061).default,K=B(18698).default,L=B(56690).default,$=B(89728).default;Ie={value:!0};var X=B(44091),Ve=B(75823),_t=" ".repeat(2),De=" ".repeat(4);function Ae(){return qe(this)}function qe(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=u.maxRows,t=n===void 0?15:n,e=u.maxColumns,r=e===void 0?10:e,s=u.maxNumSize,i=s===void 0?8:s,a=u.padMinus,h=a===void 0?"auto":a;return"".concat(o.constructor.name,` {
`).concat(_t,`[
`).concat(De).concat(xe(o,t,r,i,h),`
`).concat(_t,`]
`).concat(_t,"rows: ").concat(o.rows,`
`).concat(_t,"columns: ").concat(o.columns,`
}`)}function xe(o,u,n,t,e){var r=o.rows,s=o.columns,i=Math.min(r,u),a=Math.min(s,n),h=[];if(e==="auto"){e=!1;t:for(var f=0;f<i;f++)for(var v=0;v<a;v++)if(o.get(f,v)<0){e=!0;break t}}for(var c=0;c<i;c++){for(var w=[],g=0;g<a;g++)w.push(He(o.get(c,g),t,e));h.push("".concat(w.join(" ")))}return a!==s&&(h[h.length-1]+=" ... ".concat(s-n," more columns")),i!==r&&h.push("... ".concat(r-u," more rows")),h.join(`
`.concat(De))}function He(o,u,n){return(o>=0&&n?" ".concat(ze(o,u-1)):ze(o,u)).padEnd(u)}function ze(o,u){var n=o.toString();if(n.length<=u)return n;var t=o.toFixed(u);if(t.length>u&&(t=o.toFixed(Math.max(0,u-(t.length-u)))),t.length<=u&&!t.startsWith("0.000")&&!t.startsWith("-0.000"))return t;var e=o.toExponential(u);return e.length>u&&(e=o.toExponential(Math.max(0,u-(e.length-u)))),e.slice(0)}function je(o,u){o.prototype.add=function(t){return typeof t=="number"?this.addS(t):this.addM(t)},o.prototype.addS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},o.prototype.addM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},o.add=function(t,e){var r=new u(t);return r.add(e)},o.prototype.sub=function(t){return typeof t=="number"?this.subS(t):this.subM(t)},o.prototype.subS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},o.prototype.subM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},o.sub=function(t,e){var r=new u(t);return r.sub(e)},o.prototype.subtract=o.prototype.sub,o.prototype.subtractS=o.prototype.subS,o.prototype.subtractM=o.prototype.subM,o.subtract=o.sub,o.prototype.mul=function(t){return typeof t=="number"?this.mulS(t):this.mulM(t)},o.prototype.mulS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},o.prototype.mulM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},o.mul=function(t,e){var r=new u(t);return r.mul(e)},o.prototype.multiply=o.prototype.mul,o.prototype.multiplyS=o.prototype.mulS,o.prototype.multiplyM=o.prototype.mulM,o.multiply=o.mul,o.prototype.div=function(t){return typeof t=="number"?this.divS(t):this.divM(t)},o.prototype.divS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},o.prototype.divM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},o.div=function(t,e){var r=new u(t);return r.div(e)},o.prototype.divide=o.prototype.div,o.prototype.divideS=o.prototype.divS,o.prototype.divideM=o.prototype.divM,o.divide=o.div,o.prototype.mod=function(t){return typeof t=="number"?this.modS(t):this.modM(t)},o.prototype.modS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},o.prototype.modM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},o.mod=function(t,e){var r=new u(t);return r.mod(e)},o.prototype.modulus=o.prototype.mod,o.prototype.modulusS=o.prototype.modS,o.prototype.modulusM=o.prototype.modM,o.modulus=o.mod,o.prototype.and=function(t){return typeof t=="number"?this.andS(t):this.andM(t)},o.prototype.andS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},o.prototype.andM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},o.and=function(t,e){var r=new u(t);return r.and(e)},o.prototype.or=function(t){return typeof t=="number"?this.orS(t):this.orM(t)},o.prototype.orS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},o.prototype.orM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},o.or=function(t,e){var r=new u(t);return r.or(e)},o.prototype.xor=function(t){return typeof t=="number"?this.xorS(t):this.xorM(t)},o.prototype.xorS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},o.prototype.xorM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},o.xor=function(t,e){var r=new u(t);return r.xor(e)},o.prototype.leftShift=function(t){return typeof t=="number"?this.leftShiftS(t):this.leftShiftM(t)},o.prototype.leftShiftS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},o.prototype.leftShiftM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},o.leftShift=function(t,e){var r=new u(t);return r.leftShift(e)},o.prototype.signPropagatingRightShift=function(t){return typeof t=="number"?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},o.prototype.signPropagatingRightShiftS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},o.prototype.signPropagatingRightShiftM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},o.signPropagatingRightShift=function(t,e){var r=new u(t);return r.signPropagatingRightShift(e)},o.prototype.rightShift=function(t){return typeof t=="number"?this.rightShiftS(t):this.rightShiftM(t)},o.prototype.rightShiftS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},o.prototype.rightShiftM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},o.rightShift=function(t,e){var r=new u(t);return r.rightShift(e)},o.prototype.zeroFillRightShift=o.prototype.rightShift,o.prototype.zeroFillRightShiftS=o.prototype.rightShiftS,o.prototype.zeroFillRightShiftM=o.prototype.rightShiftM,o.zeroFillRightShift=o.rightShift,o.prototype.not=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},o.not=function(t){var e=new u(t);return e.not()},o.prototype.abs=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},o.abs=function(t){var e=new u(t);return e.abs()},o.prototype.acos=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},o.acos=function(t){var e=new u(t);return e.acos()},o.prototype.acosh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},o.acosh=function(t){var e=new u(t);return e.acosh()},o.prototype.asin=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},o.asin=function(t){var e=new u(t);return e.asin()},o.prototype.asinh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},o.asinh=function(t){var e=new u(t);return e.asinh()},o.prototype.atan=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},o.atan=function(t){var e=new u(t);return e.atan()},o.prototype.atanh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},o.atanh=function(t){var e=new u(t);return e.atanh()},o.prototype.cbrt=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},o.cbrt=function(t){var e=new u(t);return e.cbrt()},o.prototype.ceil=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},o.ceil=function(t){var e=new u(t);return e.ceil()},o.prototype.clz32=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},o.clz32=function(t){var e=new u(t);return e.clz32()},o.prototype.cos=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},o.cos=function(t){var e=new u(t);return e.cos()},o.prototype.cosh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},o.cosh=function(t){var e=new u(t);return e.cosh()},o.prototype.exp=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},o.exp=function(t){var e=new u(t);return e.exp()},o.prototype.expm1=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},o.expm1=function(t){var e=new u(t);return e.expm1()},o.prototype.floor=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},o.floor=function(t){var e=new u(t);return e.floor()},o.prototype.fround=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},o.fround=function(t){var e=new u(t);return e.fround()},o.prototype.log=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},o.log=function(t){var e=new u(t);return e.log()},o.prototype.log1p=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},o.log1p=function(t){var e=new u(t);return e.log1p()},o.prototype.log10=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},o.log10=function(t){var e=new u(t);return e.log10()},o.prototype.log2=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},o.log2=function(t){var e=new u(t);return e.log2()},o.prototype.round=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},o.round=function(t){var e=new u(t);return e.round()},o.prototype.sign=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},o.sign=function(t){var e=new u(t);return e.sign()},o.prototype.sin=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},o.sin=function(t){var e=new u(t);return e.sin()},o.prototype.sinh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},o.sinh=function(t){var e=new u(t);return e.sinh()},o.prototype.sqrt=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},o.sqrt=function(t){var e=new u(t);return e.sqrt()},o.prototype.tan=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},o.tan=function(t){var e=new u(t);return e.tan()},o.prototype.tanh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},o.tanh=function(t){var e=new u(t);return e.tanh()},o.prototype.trunc=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},o.trunc=function(t){var e=new u(t);return e.trunc()},o.pow=function(t,e){var r=new u(t);return r.pow(e)},o.prototype.pow=function(t){return typeof t=="number"?this.powS(t):this.powM(t)},o.prototype.powS=function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},o.prototype.powM=function(t){if(t=u.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}function tt(o,u,n){var t=n?o.rows:o.rows-1;if(u<0||u>t)throw new RangeError("Row index out of range")}function et(o,u,n){var t=n?o.columns:o.columns-1;if(u<0||u>t)throw new RangeError("Column index out of range")}function Tt(o,u){if(u.to1DArray&&(u=u.to1DArray()),u.length!==o.columns)throw new RangeError("vector size must be the same as the number of columns");return u}function Ct(o,u){if(u.to1DArray&&(u=u.to1DArray()),u.length!==o.rows)throw new RangeError("vector size must be the same as the number of rows");return u}function le(o,u){if(!X.isAnyArray(u))throw new TypeError("row indices must be an array");for(var n=0;n<u.length;n++)if(u[n]<0||u[n]>=o.rows)throw new RangeError("row indices are out of range")}function ce(o,u){if(!X.isAnyArray(u))throw new TypeError("column indices must be an array");for(var n=0;n<u.length;n++)if(u[n]<0||u[n]>=o.columns)throw new RangeError("column indices are out of range")}function ge(o,u,n,t,e){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(ee("startRow",u),ee("endRow",n),ee("startColumn",t),ee("endColumn",e),u>n||t>e||u<0||u>=o.rows||n<0||n>=o.rows||t<0||t>=o.columns||e<0||e>=o.columns)throw new RangeError("Submatrix indices are out of range")}function te(o){for(var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],t=0;t<o;t++)n.push(u);return n}function ee(o,u){if(typeof u!="number")throw new TypeError("".concat(o," must be a number"))}function Ft(o){if(o.isEmpty())throw new Error("Empty matrix has no elements to index")}function _e(o){for(var u=te(o.rows),n=0;n<o.rows;++n)for(var t=0;t<o.columns;++t)u[n]+=o.get(n,t);return u}function tr(o){for(var u=te(o.columns),n=0;n<o.rows;++n)for(var t=0;t<o.columns;++t)u[t]+=o.get(n,t);return u}function er(o){for(var u=0,n=0;n<o.rows;n++)for(var t=0;t<o.columns;t++)u+=o.get(n,t);return u}function rr(o){for(var u=te(o.rows,1),n=0;n<o.rows;++n)for(var t=0;t<o.columns;++t)u[n]*=o.get(n,t);return u}function nr(o){for(var u=te(o.columns,1),n=0;n<o.rows;++n)for(var t=0;t<o.columns;++t)u[t]*=o.get(n,t);return u}function sr(o){for(var u=1,n=0;n<o.rows;n++)for(var t=0;t<o.columns;t++)u*=o.get(n,t);return u}function or(o,u,n){for(var t=o.rows,e=o.columns,r=[],s=0;s<t;s++){for(var i=0,a=0,h=0,f=0;f<e;f++)h=o.get(s,f)-n[s],i+=h,a+=h*h;u?r.push((a-i*i/e)/(e-1)):r.push((a-i*i/e)/e)}return r}function ar(o,u,n){for(var t=o.rows,e=o.columns,r=[],s=0;s<e;s++){for(var i=0,a=0,h=0,f=0;f<t;f++)h=o.get(f,s)-n[s],i+=h,a+=h*h;u?r.push((a-i*i/t)/(t-1)):r.push((a-i*i/t)/t)}return r}function ir(o,u,n){for(var t=o.rows,e=o.columns,r=t*e,s=0,i=0,a=0,h=0;h<t;h++)for(var f=0;f<e;f++)a=o.get(h,f)-n,s+=a,i+=a*a;return u?(i-s*s/r)/(r-1):(i-s*s/r)/r}function ur(o,u){for(var n=0;n<o.rows;n++)for(var t=0;t<o.columns;t++)o.set(n,t,o.get(n,t)-u[n])}function hr(o,u){for(var n=0;n<o.rows;n++)for(var t=0;t<o.columns;t++)o.set(n,t,o.get(n,t)-u[t])}function fr(o,u){for(var n=0;n<o.rows;n++)for(var t=0;t<o.columns;t++)o.set(n,t,o.get(n,t)-u)}function vr(o){for(var u=[],n=0;n<o.rows;n++){for(var t=0,e=0;e<o.columns;e++)t+=Math.pow(o.get(n,e),2)/(o.columns-1);u.push(Math.sqrt(t))}return u}function lr(o,u){for(var n=0;n<o.rows;n++)for(var t=0;t<o.columns;t++)o.set(n,t,o.get(n,t)/u[n])}function cr(o){for(var u=[],n=0;n<o.columns;n++){for(var t=0,e=0;e<o.rows;e++)t+=Math.pow(o.get(e,n),2)/(o.rows-1);u.push(Math.sqrt(t))}return u}function gr(o,u){for(var n=0;n<o.rows;n++)for(var t=0;t<o.columns;t++)o.set(n,t,o.get(n,t)/u[t])}function mr(o){for(var u=o.size-1,n=0,t=0;t<o.columns;t++)for(var e=0;e<o.rows;e++)n+=Math.pow(o.get(e,t),2)/u;return Math.sqrt(n)}function wr(o,u){for(var n=0;n<o.rows;n++)for(var t=0;t<o.columns;t++)o.set(n,t,o.get(n,t)/u)}var P=function(o){function u(){L(this,u)}return $(u,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(t){if(typeof t!="function")throw new TypeError("callback must be a function");for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.call(this,e,r);return this}},{key:"to1DArray",value:function(){for(var t=[],e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.push(this.get(e,r));return t}},{key:"to2DArray",value:function(){for(var t=[],e=0;e<this.rows;e++){t.push([]);for(var r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return this.rows===1}},{key:"isColumnVector",value:function(){return this.columns===1}},{key:"isVector",value:function(){return this.rows===1||this.columns===1}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return this.rows===0||this.columns===0}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}},{key:"isDistance",value:function(){if(!this.isSymmetric())return!1;for(var t=0;t<this.rows;t++)if(this.get(t,t)!==0)return!1;return!0}},{key:"isEchelonForm",value:function(){for(var t=0,e=0,r=-1,s=!0,i=!1;t<this.rows&&s;){for(e=0,i=!1;e<this.columns&&i===!1;)this.get(t,e)===0?e++:this.get(t,e)===1&&e>r?(i=!0,r=e):(s=!1,i=!0);t++}return s}},{key:"isReducedEchelonForm",value:function(){for(var t=0,e=0,r=-1,s=!0,i=!1;t<this.rows&&s;){for(e=0,i=!1;e<this.columns&&i===!1;)this.get(t,e)===0?e++:this.get(t,e)===1&&e>r?(i=!0,r=e):(s=!1,i=!0);for(var a=e+1;a<this.rows;a++)this.get(t,a)!==0&&(s=!1);t++}return s}},{key:"echelonForm",value:function(){for(var t=this.clone(),e=0,r=0;e<t.rows&&r<t.columns;){for(var s=e,i=e;i<t.rows;i++)t.get(i,r)>t.get(s,r)&&(s=i);if(t.get(s,r)===0)r++;else{t.swapRows(e,s);for(var a=t.get(e,r),h=r;h<t.columns;h++)t.set(e,h,t.get(e,h)/a);for(var f=e+1;f<t.rows;f++){var v=t.get(f,r)/t.get(e,r);t.set(f,r,0);for(var c=r+1;c<t.columns;c++)t.set(f,c,t.get(f,c)-t.get(e,c)*v)}e++,r++}}return t}},{key:"reducedEchelonForm",value:function(){for(var t=this.echelonForm(),e=t.columns,r=t.rows,s=r-1;s>=0;)if(t.maxRow(s)===0)s--;else{for(var i=0,a=!1;i<r&&a===!1;)t.get(s,i)===1?a=!0:i++;for(var h=0;h<s;h++)for(var f=t.get(h,i),v=i;v<e;v++){var c=t.get(h,v)-f*t.get(s,v);t.set(h,v,c)}s--}return t}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(K(t)!=="object")throw new TypeError("options must be an object");var e=t.rows,r=e===void 0?1:e,s=t.columns,i=s===void 0?1:s;if(!Number.isInteger(r)||r<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new TypeError("columns must be a positive integer");for(var a=new S(this.rows*r,this.columns*i),h=0;h<r;h++)for(var f=0;f<i;f++)a.setSubMatrix(this,this.rows*h,this.columns*f);return a}},{key:"fill",value:function(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,t);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(t){tt(this,t);for(var e=[],r=0;r<this.columns;r++)e.push(this.get(t,r));return e}},{key:"getRowVector",value:function(t){return S.rowVector(this.getRow(t))}},{key:"setRow",value:function(t,e){tt(this,t),e=Tt(this,e);for(var r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}},{key:"swapRows",value:function(t,e){tt(this,t),tt(this,e);for(var r=0;r<this.columns;r++){var s=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,s)}return this}},{key:"getColumn",value:function(t){et(this,t);for(var e=[],r=0;r<this.rows;r++)e.push(this.get(r,t));return e}},{key:"getColumnVector",value:function(t){return S.columnVector(this.getColumn(t))}},{key:"setColumn",value:function(t,e){et(this,t),e=Ct(this,e);for(var r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}},{key:"swapColumns",value:function(t,e){et(this,t),et(this,e);for(var r=0;r<this.rows;r++){var s=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,s)}return this}},{key:"addRowVector",value:function(t){t=Tt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}},{key:"subRowVector",value:function(t){t=Tt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}},{key:"mulRowVector",value:function(t){t=Tt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}},{key:"divRowVector",value:function(t){t=Tt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}},{key:"addColumnVector",value:function(t){t=Ct(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}},{key:"subColumnVector",value:function(t){t=Ct(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}},{key:"mulColumnVector",value:function(t){t=Ct(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}},{key:"divColumnVector",value:function(t){t=Ct(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}},{key:"mulRow",value:function(t,e){tt(this,t);for(var r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}},{key:"mulColumn",value:function(t,e){et(this,t);for(var r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}},{key:"max",value:function(t){if(this.isEmpty())return NaN;switch(t){case"row":{for(var e=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),r=0;r<this.rows;r++)for(var s=0;s<this.columns;s++)this.get(r,s)>e[r]&&(e[r]=this.get(r,s));return e}case"column":{for(var i=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),a=0;a<this.rows;a++)for(var h=0;h<this.columns;h++)this.get(a,h)>i[h]&&(i[h]=this.get(a,h));return i}case void 0:{for(var f=this.get(0,0),v=0;v<this.rows;v++)for(var c=0;c<this.columns;c++)this.get(v,c)>f&&(f=this.get(v,c));return f}default:throw new Error("invalid option: ".concat(t))}}},{key:"maxIndex",value:function(){Ft(this);for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var s=0;s<this.columns;s++)this.get(r,s)>t&&(t=this.get(r,s),e[0]=r,e[1]=s);return e}},{key:"min",value:function(t){if(this.isEmpty())return NaN;switch(t){case"row":{for(var e=new Array(this.rows).fill(Number.POSITIVE_INFINITY),r=0;r<this.rows;r++)for(var s=0;s<this.columns;s++)this.get(r,s)<e[r]&&(e[r]=this.get(r,s));return e}case"column":{for(var i=new Array(this.columns).fill(Number.POSITIVE_INFINITY),a=0;a<this.rows;a++)for(var h=0;h<this.columns;h++)this.get(a,h)<i[h]&&(i[h]=this.get(a,h));return i}case void 0:{for(var f=this.get(0,0),v=0;v<this.rows;v++)for(var c=0;c<this.columns;c++)this.get(v,c)<f&&(f=this.get(v,c));return f}default:throw new Error("invalid option: ".concat(t))}}},{key:"minIndex",value:function(){Ft(this);for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var s=0;s<this.columns;s++)this.get(r,s)<t&&(t=this.get(r,s),e[0]=r,e[1]=s);return e}},{key:"maxRow",value:function(t){if(tt(this,t),this.isEmpty())return NaN;for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}},{key:"maxRowIndex",value:function(t){tt(this,t),Ft(this);for(var e=this.get(t,0),r=[t,0],s=1;s<this.columns;s++)this.get(t,s)>e&&(e=this.get(t,s),r[1]=s);return r}},{key:"minRow",value:function(t){if(tt(this,t),this.isEmpty())return NaN;for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}},{key:"minRowIndex",value:function(t){tt(this,t),Ft(this);for(var e=this.get(t,0),r=[t,0],s=1;s<this.columns;s++)this.get(t,s)<e&&(e=this.get(t,s),r[1]=s);return r}},{key:"maxColumn",value:function(t){if(et(this,t),this.isEmpty())return NaN;for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}},{key:"maxColumnIndex",value:function(t){et(this,t),Ft(this);for(var e=this.get(0,t),r=[0,t],s=1;s<this.rows;s++)this.get(s,t)>e&&(e=this.get(s,t),r[0]=s);return r}},{key:"minColumn",value:function(t){if(et(this,t),this.isEmpty())return NaN;for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}},{key:"minColumnIndex",value:function(t){et(this,t),Ft(this);for(var e=this.get(0,t),r=[0,t],s=1;s<this.rows;s++)this.get(s,t)<e&&(e=this.get(s,t),r[0]=s);return r}},{key:"diag",value:function(){for(var t=Math.min(this.rows,this.columns),e=[],r=0;r<t;r++)e.push(this.get(r,r));return e}},{key:"norm",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"frobenius";switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError("unknown norm type: ".concat(t))}}},{key:"cumulativeSum",value:function(){for(var t=0,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}},{key:"dot",value:function(t){u.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var r=0,s=0;s<e.length;s++)r+=e[s]*t[s];return r}},{key:"mmul",value:function(t){t=S.checkMatrix(t);for(var e=this.rows,r=this.columns,s=t.columns,i=new S(e,s),a=new Float64Array(r),h=0;h<s;h++){for(var f=0;f<r;f++)a[f]=t.get(f,h);for(var v=0;v<e;v++){for(var c=0,w=0;w<r;w++)c+=this.get(v,w)*a[w];i.set(v,h,c)}}return i}},{key:"mpow",value:function(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");for(var e=S.eye(this.rows),r=this,s=t;s>=1;s/=2)s&1&&(e=e.mmul(r)),r=r.mmul(r);return e}},{key:"strassen2x2",value:function(t){t=S.checkMatrix(t);var e=new S(2,2),r=this.get(0,0),s=t.get(0,0),i=this.get(0,1),a=t.get(0,1),h=this.get(1,0),f=t.get(1,0),v=this.get(1,1),c=t.get(1,1),w=(r+v)*(s+c),g=(h+v)*s,d=r*(a-c),R=v*(f-s),l=(r+i)*c,m=(h-r)*(s+a),p=(i-v)*(f+c),E=w+R-l+p,y=d+l,C=g+R,F=w-g+d+m;return e.set(0,0,E),e.set(0,1,y),e.set(1,0,C),e.set(1,1,F),e}},{key:"strassen3x3",value:function(t){t=S.checkMatrix(t);var e=new S(3,3),r=this.get(0,0),s=this.get(0,1),i=this.get(0,2),a=this.get(1,0),h=this.get(1,1),f=this.get(1,2),v=this.get(2,0),c=this.get(2,1),w=this.get(2,2),g=t.get(0,0),d=t.get(0,1),R=t.get(0,2),l=t.get(1,0),m=t.get(1,1),p=t.get(1,2),E=t.get(2,0),y=t.get(2,1),C=t.get(2,2),F=(r+s+i-a-h-c-w)*m,k=(r-a)*(-d+m),N=h*(-g+d+l-m-p-E+C),q=(-r+a+h)*(g-d+m),Q=(a+h)*(-g+d),M=r*g,A=(-r+v+c)*(g-R+p),Y=(-r+v)*(R-p),D=(v+c)*(-g+R),ct=(r+s+i-h-f-v-c)*p,gt=c*(-g+R+l-m-p-E+y),U=(-i+c+w)*(m+E-y),vt=(i-w)*(m-y),j=i*E,ut=(c+w)*(-E+y),O=(-i+h+f)*(p+E-C),dt=(i-f)*(p-C),St=(h+f)*(-E+C),Mt=s*l,pe=f*y,Et=a*R,Dt=v*d,V=w*C,bt=M+j+Mt,Qt=F+q+Q+M+U+j+ut,z=M+A+D+ct+j+O+St,kt=k+N+q+M+j+O+dt,qt=k+q+Q+M+pe,zt=j+O+dt+St+Et,Rt=M+A+Y+gt+U+vt+j,Pt=U+vt+j+ut+Dt,Yt=M+A+Y+D+V;return e.set(0,0,bt),e.set(0,1,Qt),e.set(0,2,z),e.set(1,0,kt),e.set(1,1,qt),e.set(1,2,zt),e.set(2,0,Rt),e.set(2,1,Pt),e.set(2,2,Yt),e}},{key:"mmulStrassen",value:function(t){t=S.checkMatrix(t);var e=this.clone(),r=e.rows,s=e.columns,i=t.rows,a=t.columns;s!==i&&console.warn("Multiplying ".concat(r," x ").concat(s," and ").concat(i," x ").concat(a," matrix: dimensions do not match."));function h(w,g,d){var R=w.rows,l=w.columns;if(R===g&&l===d)return w;var m=u.zeros(g,d);return m=m.setSubMatrix(w,0,0),m}var f=Math.max(r,i),v=Math.max(s,a);e=h(e,f,v),t=h(t,f,v);function c(w,g,d,R){if(d<=512||R<=512)return w.mmul(g);d%2===1&&R%2===1?(w=h(w,d+1,R+1),g=h(g,d+1,R+1)):d%2===1?(w=h(w,d+1,R),g=h(g,d+1,R)):R%2===1&&(w=h(w,d,R+1),g=h(g,d,R+1));var l=parseInt(w.rows/2,10),m=parseInt(w.columns/2,10),p=w.subMatrix(0,l-1,0,m-1),E=g.subMatrix(0,l-1,0,m-1),y=w.subMatrix(0,l-1,m,w.columns-1),C=g.subMatrix(0,l-1,m,g.columns-1),F=w.subMatrix(l,w.rows-1,0,m-1),k=g.subMatrix(l,g.rows-1,0,m-1),N=w.subMatrix(l,w.rows-1,m,w.columns-1),q=g.subMatrix(l,g.rows-1,m,g.columns-1),Q=c(u.add(p,N),u.add(E,q),l,m),M=c(u.add(F,N),E,l,m),A=c(p,u.sub(C,q),l,m),Y=c(N,u.sub(k,E),l,m),D=c(u.add(p,y),q,l,m),ct=c(u.sub(F,p),u.add(E,C),l,m),gt=c(u.sub(y,N),u.add(k,q),l,m),U=u.add(Q,Y);U.sub(D),U.add(gt);var vt=u.add(A,D),j=u.add(M,Y),ut=u.sub(Q,M);ut.add(A),ut.add(ct);var O=u.zeros(2*U.rows,2*U.columns);return O=O.setSubMatrix(U,0,0),O=O.setSubMatrix(vt,U.rows,0),O=O.setSubMatrix(j,0,U.columns),O=O.setSubMatrix(ut,U.rows,U.columns),O.subMatrix(0,d-1,0,R-1)}return c(e,t,f,v)}},{key:"scaleRows",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(K(t)!=="object")throw new TypeError("options must be an object");var e=t.min,r=e===void 0?0:e,s=t.max,i=s===void 0?1:s;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(r>=i)throw new RangeError("min must be smaller than max");for(var a=new S(this.rows,this.columns),h=0;h<this.rows;h++){var f=this.getRow(h);f.length>0&&Ve(f,{min:r,max:i,output:f}),a.setRow(h,f)}return a}},{key:"scaleColumns",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(K(t)!=="object")throw new TypeError("options must be an object");var e=t.min,r=e===void 0?0:e,s=t.max,i=s===void 0?1:s;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(r>=i)throw new RangeError("min must be smaller than max");for(var a=new S(this.rows,this.columns),h=0;h<this.columns;h++){var f=this.getColumn(h);f.length&&Ve(f,{min:r,max:i,output:f}),a.setColumn(h,f)}return a}},{key:"flipRows",value:function(){for(var t=Math.ceil(this.columns/2),e=0;e<this.rows;e++)for(var r=0;r<t;r++){var s=this.get(e,r),i=this.get(e,this.columns-1-r);this.set(e,r,i),this.set(e,this.columns-1-r,s)}return this}},{key:"flipColumns",value:function(){for(var t=Math.ceil(this.rows/2),e=0;e<this.columns;e++)for(var r=0;r<t;r++){var s=this.get(r,e),i=this.get(this.rows-1-r,e);this.set(r,e,i),this.set(this.rows-1-r,e,s)}return this}},{key:"kroneckerProduct",value:function(t){t=S.checkMatrix(t);for(var e=this.rows,r=this.columns,s=t.rows,i=t.columns,a=new S(e*s,r*i),h=0;h<e;h++)for(var f=0;f<r;f++)for(var v=0;v<s;v++)for(var c=0;c<i;c++)a.set(s*h+v,i*f+c,this.get(h,f)*t.get(v,c));return a}},{key:"kroneckerSum",value:function(t){if(t=S.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var e=this.rows,r=t.rows,s=this.kroneckerProduct(S.eye(r,r)),i=S.eye(e,e).kroneckerProduct(t);return s.add(i)}},{key:"transpose",value:function(){for(var t=new S(this.columns,this.rows),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}},{key:"sortRows",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pe,e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}},{key:"sortColumns",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pe,e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}},{key:"subMatrix",value:function(t,e,r,s){ge(this,t,e,r,s);for(var i=new S(e-t+1,s-r+1),a=t;a<=e;a++)for(var h=r;h<=s;h++)i.set(a-t,h-r,this.get(a,h));return i}},{key:"subMatrixRow",value:function(t,e,r){if(e===void 0&&(e=0),r===void 0&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");for(var s=new S(t.length,r-e+1),i=0;i<t.length;i++)for(var a=e;a<=r;a++){if(t[i]<0||t[i]>=this.rows)throw new RangeError("Row index out of range: ".concat(t[i]));s.set(i,a-e,this.get(t[i],a))}return s}},{key:"subMatrixColumn",value:function(t,e,r){if(e===void 0&&(e=0),r===void 0&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");for(var s=new S(r-e+1,t.length),i=0;i<t.length;i++)for(var a=e;a<=r;a++){if(t[i]<0||t[i]>=this.columns)throw new RangeError("Column index out of range: ".concat(t[i]));s.set(a-e,i,this.get(a,t[i]))}return s}},{key:"setSubMatrix",value:function(t,e,r){if(t=S.checkMatrix(t),t.isEmpty())return this;var s=e+t.rows-1,i=r+t.columns-1;ge(this,e,s,r,i);for(var a=0;a<t.rows;a++)for(var h=0;h<t.columns;h++)this.set(e+a,r+h,t.get(a,h));return this}},{key:"selection",value:function(t,e){le(this,t),ce(this,e);for(var r=new S(t.length,e.length),s=0;s<t.length;s++)for(var i=t[s],a=0;a<e.length;a++){var h=e[a];r.set(s,a,this.get(i,h))}return r}},{key:"trace",value:function(){for(var t=Math.min(this.rows,this.columns),e=0,r=0;r<t;r++)e+=this.get(r,r);return e}},{key:"clone",value:function(){return this.constructor.copy(this,new S(this.rows,this.columns))}},{key:"sum",value:function(t){switch(t){case"row":return _e(this);case"column":return tr(this);case void 0:return er(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"product",value:function(t){switch(t){case"row":return rr(this);case"column":return nr(this);case void 0:return sr(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"mean",value:function(t){var e=this.sum(t);switch(t){case"row":{for(var r=0;r<this.rows;r++)e[r]/=this.columns;return e}case"column":{for(var s=0;s<this.columns;s++)e[s]/=this.rows;return e}case void 0:return e/this.size;default:throw new Error("invalid option: ".concat(t))}}},{key:"variance",value:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(K(t)==="object"&&(e=t,t=void 0),K(e)!=="object")throw new TypeError("options must be an object");var r=e,s=r.unbiased,i=s===void 0?!0:s,a=r.mean,h=a===void 0?this.mean(t):a;if(typeof i!="boolean")throw new TypeError("unbiased must be a boolean");switch(t){case"row":{if(!X.isAnyArray(h))throw new TypeError("mean must be an array");return or(this,i,h)}case"column":{if(!X.isAnyArray(h))throw new TypeError("mean must be an array");return ar(this,i,h)}case void 0:{if(typeof h!="number")throw new TypeError("mean must be a number");return ir(this,i,h)}default:throw new Error("invalid option: ".concat(t))}}},{key:"standardDeviation",value:function(t,e){K(t)==="object"&&(e=t,t=void 0);var r=this.variance(t,e);if(t===void 0)return Math.sqrt(r);for(var s=0;s<r.length;s++)r[s]=Math.sqrt(r[s]);return r}},{key:"center",value:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(K(t)==="object"&&(e=t,t=void 0),K(e)!=="object")throw new TypeError("options must be an object");var r=e,s=r.center,i=s===void 0?this.mean(t):s;switch(t){case"row":{if(!X.isAnyArray(i))throw new TypeError("center must be an array");return ur(this,i),this}case"column":{if(!X.isAnyArray(i))throw new TypeError("center must be an array");return hr(this,i),this}case void 0:{if(typeof i!="number")throw new TypeError("center must be a number");return fr(this,i),this}default:throw new Error("invalid option: ".concat(t))}}},{key:"scale",value:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(K(t)==="object"&&(e=t,t=void 0),K(e)!=="object")throw new TypeError("options must be an object");var r=e.scale;switch(t){case"row":{if(r===void 0)r=vr(this);else if(!X.isAnyArray(r))throw new TypeError("scale must be an array");return lr(this,r),this}case"column":{if(r===void 0)r=cr(this);else if(!X.isAnyArray(r))throw new TypeError("scale must be an array");return gr(this,r),this}case void 0:{if(r===void 0)r=mr(this);else if(typeof r!="number")throw new TypeError("scale must be a number");return wr(this,r),this}default:throw new Error("invalid option: ".concat(t))}}},{key:"toString",value:function(t){return qe(this,t)}},{key:o,value:function(){return this.entries()}},{key:"entries",value:lt().mark(function n(){var t,e;return lt().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:t=0;case 1:if(!(t<this.rows)){s.next=12;break}e=0;case 3:if(!(e<this.columns)){s.next=9;break}return s.next=6,[t,e,this.get(t,e)];case 6:e++,s.next=3;break;case 9:t++,s.next=1;break;case 12:case"end":return s.stop()}},n,this)})},{key:"values",value:lt().mark(function n(){var t,e;return lt().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:t=0;case 1:if(!(t<this.rows)){s.next=12;break}e=0;case 3:if(!(e<this.columns)){s.next=9;break}return s.next=6,this.get(t,e);case 6:e++,s.next=3;break;case 9:t++,s.next=1;break;case 12:case"end":return s.stop()}},n,this)})}],[{key:"from1DArray",value:function(t,e,r){var s=t*e;if(s!==r.length)throw new RangeError("data length does not match given dimensions");for(var i=new S(t,e),a=0;a<t;a++)for(var h=0;h<e;h++)i.set(a,h,r[a*e+h]);return i}},{key:"rowVector",value:function(t){for(var e=new S(1,t.length),r=0;r<t.length;r++)e.set(0,r,t[r]);return e}},{key:"columnVector",value:function(t){for(var e=new S(t.length,1),r=0;r<t.length;r++)e.set(r,0,t[r]);return e}},{key:"zeros",value:function(t,e){return new S(t,e)}},{key:"ones",value:function(t,e){return new S(t,e).fill(1)}},{key:"rand",value:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(K(r)!=="object")throw new TypeError("options must be an object");for(var s=r.random,i=s===void 0?Math.random:s,a=new S(t,e),h=0;h<t;h++)for(var f=0;f<e;f++)a.set(h,f,i());return a}},{key:"randInt",value:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(K(r)!=="object")throw new TypeError("options must be an object");var s=r.min,i=s===void 0?0:s,a=r.max,h=a===void 0?1e3:a,f=r.random,v=f===void 0?Math.random:f;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(h))throw new TypeError("max must be an integer");if(i>=h)throw new RangeError("min must be smaller than max");for(var c=h-i,w=new S(t,e),g=0;g<t;g++)for(var d=0;d<e;d++){var R=i+Math.round(v()*c);w.set(g,d,R)}return w}},{key:"eye",value:function(t,e,r){e===void 0&&(e=t),r===void 0&&(r=1);for(var s=Math.min(t,e),i=this.zeros(t,e),a=0;a<s;a++)i.set(a,a,r);return i}},{key:"diag",value:function(t,e,r){var s=t.length;e===void 0&&(e=s),r===void 0&&(r=e);for(var i=Math.min(s,e,r),a=this.zeros(e,r),h=0;h<i;h++)a.set(h,h,t[h]);return a}},{key:"min",value:function(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,s=t.columns,i=new S(r,s),a=0;a<r;a++)for(var h=0;h<s;h++)i.set(a,h,Math.min(t.get(a,h),e.get(a,h)));return i}},{key:"max",value:function(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,s=t.columns,i=new this(r,s),a=0;a<r;a++)for(var h=0;h<s;h++)i.set(a,h,Math.max(t.get(a,h),e.get(a,h)));return i}},{key:"checkMatrix",value:function(t){return u.isMatrix(t)?t:new S(t)}},{key:"isMatrix",value:function(t){return t!=null&&t.klass==="Matrix"}},{key:"copy",value:function(t,e){var r=jt(t.entries()),s;try{for(r.s();!(s=r.n()).done;){var i=Ht(s.value,3),a=i[0],h=i[1],f=i[2];e.set(a,h,f)}}catch(v){r.e(v)}finally{r.f()}return e}}]),u}(Symbol.iterator);P.prototype.klass="Matrix",typeof Symbol!="undefined"&&(P.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ae);function Pe(o,u){return o-u}function pr(o){return o.every(function(u){return typeof u=="number"})}P.random=P.rand,P.randomInt=P.randInt,P.diagonal=P.diag,P.prototype.diagonal=P.prototype.diag,P.identity=P.eye,P.prototype.negate=P.prototype.neg,P.prototype.tensorProduct=P.prototype.kroneckerProduct;var me=new WeakSet,S=function(o){W(n,o);var u=G(n);function n(t,e){var r;if(L(this,n),r=u.call(this),Xe(nt(r),me),Ze(nt(r),"data",void 0),n.isMatrix(t))Fe(nt(r),me,Le).call(nt(r),t.rows,t.columns),n.copy(t,nt(r));else if(Number.isInteger(t)&&t>=0)Fe(nt(r),me,Le).call(nt(r),t,e);else if(X.isAnyArray(t)){var s=t;if(t=s.length,e=t?s[0].length:0,typeof e!="number")throw new TypeError("Data must be a 2D array with at least one element");r.data=[];for(var i=0;i<t;i++){if(s[i].length!==e)throw new RangeError("Inconsistent array dimensions");if(!pr(s[i]))throw new TypeError("Input data contains non-numeric values");r.data.push(Float64Array.from(s[i]))}r.rows=t,r.columns=e}else throw new TypeError("First argument must be a positive number or an array");return r}return $(n,[{key:"set",value:function(e,r,s){return this.data[e][r]=s,this}},{key:"get",value:function(e,r){return this.data[e][r]}},{key:"removeRow",value:function(e){return tt(this,e),this.data.splice(e,1),this.rows-=1,this}},{key:"addRow",value:function(e,r){return r===void 0&&(r=e,e=this.rows),tt(this,e,!0),r=Float64Array.from(Tt(this,r)),this.data.splice(e,0,r),this.rows+=1,this}},{key:"removeColumn",value:function(e){et(this,e);for(var r=0;r<this.rows;r++){for(var s=new Float64Array(this.columns-1),i=0;i<e;i++)s[i]=this.data[r][i];for(var a=e+1;a<this.columns;a++)s[a-1]=this.data[r][a];this.data[r]=s}return this.columns-=1,this}},{key:"addColumn",value:function(e,r){typeof r=="undefined"&&(r=e,e=this.columns),et(this,e,!0),r=Ct(this,r);for(var s=0;s<this.rows;s++){for(var i=new Float64Array(this.columns+1),a=0;a<e;a++)i[a]=this.data[s][a];for(i[a++]=r[s];a<this.columns+1;a++)i[a]=this.data[s][a-1];this.data[s]=i}return this.columns+=1,this}}]),n}(P);function Le(o,u){if(this.data=[],Number.isInteger(u)&&u>=0)for(var n=0;n<o;n++)this.data.push(new Float64Array(u));else throw new TypeError("nColumns must be a positive integer");this.rows=o,this.columns=u}je(P,S);var Z=new WeakMap,Ot=function(o){W(n,o);var u=G(n);function n(t){var e;if(L(this,n),e=u.call(this),Ke(nt(e),Z,{writable:!0,value:void 0}),S.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");ve(nt(e),Z,S.copy(t,new S(t.rows,t.rows)))}else if(Number.isInteger(t)&&t>=0)ve(nt(e),Z,new S(t,t));else if(ve(nt(e),Z,new S(t)),!e.isSymmetric())throw new TypeError("not symmetric data");return e}return $(n,[{key:"size",get:function(){return it(this,Z).size}},{key:"rows",get:function(){return it(this,Z).rows}},{key:"columns",get:function(){return it(this,Z).columns}},{key:"diagonalSize",get:function(){return this.rows}},{key:"clone",value:function(){var e=new n(this.diagonalSize),r=jt(this.upperRightEntries()),s;try{for(r.s();!(s=r.n()).done;){var i=Ht(s.value,3),a=i[0],h=i[1],f=i[2];e.set(a,h,f)}}catch(v){r.e(v)}finally{r.f()}return e}},{key:"toMatrix",value:function(){return new S(this)}},{key:"get",value:function(e,r){return it(this,Z).get(e,r)}},{key:"set",value:function(e,r,s){return it(this,Z).set(e,r,s),it(this,Z).set(r,e,s),this}},{key:"removeCross",value:function(e){return it(this,Z).removeRow(e),it(this,Z).removeColumn(e),this}},{key:"addCross",value:function(e,r){r===void 0&&(r=e,e=this.diagonalSize);var s=r.slice();return s.splice(e,1),it(this,Z).addRow(e,s),it(this,Z).addColumn(e,r),this}},{key:"applyMask",value:function(e){if(e.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");var r=[],s=jt(e.entries()),i;try{for(s.s();!(i=s.n()).done;){var a=Ht(i.value,2),h=a[0],f=a[1];f||r.push(h)}}catch(g){s.e(g)}finally{s.f()}r.reverse();for(var v=0,c=r;v<c.length;v++){var w=c[v];this.removeCross(w)}return this}},{key:"toCompact",value:function(){for(var e=this.diagonalSize,r=new Array(e*(e+1)/2),s=0,i=0,a=0;a<r.length;a++)r[a]=this.get(i,s),++s>=e&&(s=++i);return r}},{key:"upperRightEntries",value:lt().mark(function t(){var e,r,s;return lt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e=0,r=0;case 1:if(!(e<this.diagonalSize)){a.next=9;break}return s=this.get(e,r),a.next=5,[e,r,s];case 5:++r>=this.diagonalSize&&(r=++e);case 6:a.next=1;break;case 9:case"end":return a.stop()}},t,this)})},{key:"upperRightValues",value:lt().mark(function t(){var e,r,s;return lt().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e=0,r=0;case 1:if(!(e<this.diagonalSize)){a.next=9;break}return s=this.get(e,r),a.next=5,s;case 5:++r>=this.diagonalSize&&(r=++e);case 6:a.next=1;break;case 9:case"end":return a.stop()}},t,this)})}],[{key:"isSymmetricMatrix",value:function(e){return S.isMatrix(e)&&e.klassType==="SymmetricMatrix"}},{key:"zeros",value:function(e){return new this(e)}},{key:"ones",value:function(e){return new this(e).fill(1)}},{key:"fromCompact",value:function(e){var r=e.length,s=(Math.sqrt(8*r+1)-1)/2;if(!Number.isInteger(s))throw new TypeError("This array is not a compact representation of a Symmetric Matrix, ".concat(JSON.stringify(e)));for(var i=new n(s),a=0,h=0,f=0;f<r;f++)i.set(a,h,e[f]),++a>=s&&(a=++h);return i}}]),n}(P);Ot.prototype.klassType="SymmetricMatrix";var $e=function(o){W(n,o);var u=G(n);function n(t){var e;if(L(this,n),e=u.call(this,t),!e.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix");return e}return $(n,[{key:"set",value:function(e,r,s){return e===r&&(s=0),Te(Ce(n.prototype),"set",this).call(this,e,r,s)}},{key:"addCross",value:function(e,r){return r===void 0&&(r=e,e=this.diagonalSize),r=r.slice(),r[e]=0,Te(Ce(n.prototype),"addCross",this).call(this,e,r)}},{key:"toSymmetricMatrix",value:function(){return new Ot(this)}},{key:"clone",value:function(){var e=new n(this.diagonalSize),r=jt(this.upperRightEntries()),s;try{for(r.s();!(s=r.n()).done;){var i=Ht(s.value,3),a=i[0],h=i[1],f=i[2];a!==h&&e.set(a,h,f)}}catch(v){r.e(v)}finally{r.f()}return e}},{key:"toCompact",value:function(){for(var e=this.diagonalSize,r=(e-1)*e/2,s=new Array(r),i=1,a=0,h=0;h<s.length;h++)s[h]=this.get(a,i),++i>=e&&(i=++a+1);return s}}],[{key:"isDistanceMatrix",value:function(e){return Ot.isSymmetricMatrix(e)&&e.klassSubType==="DistanceMatrix"}},{key:"fromCompact",value:function(e){var r=e.length;if(r===0)return new this(0);var s=(Math.sqrt(8*r+1)+1)/2;if(!Number.isInteger(s))throw new TypeError("This array is not a compact representation of a DistanceMatrix, ".concat(JSON.stringify(e)));for(var i=new this(s),a=1,h=0,f=0;f<r;f++)i.set(a,h,e[f]),++a>=s&&(a=++h+1);return i}}]),n}(Ot);$e.prototype.klassSubType="DistanceMatrix";var ht=function(o){W(n,o);var u=G(n);function n(t,e,r){var s;return L(this,n),s=u.call(this),s.matrix=t,s.rows=e,s.columns=r,s}return $(n)}(P),yr=function(o){W(n,o);var u=G(n);function n(t,e){var r;return L(this,n),et(t,e),r=u.call(this,t,t.rows,1),r.column=e,r}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(e,this.column,s),this}},{key:"get",value:function(e){return this.matrix.get(e,this.column)}}]),n}(ht),dr=function(o){W(n,o);var u=G(n);function n(t,e){var r;return L(this,n),ce(t,e),r=u.call(this,t,t.rows,e.length),r.columnIndices=e,r}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(e,this.columnIndices[r],s),this}},{key:"get",value:function(e,r){return this.matrix.get(e,this.columnIndices[r])}}]),n}(ht),Sr=function(o){W(n,o);var u=G(n);function n(t){return L(this,n),u.call(this,t,t.rows,t.columns)}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(e,this.columns-r-1,s),this}},{key:"get",value:function(e,r){return this.matrix.get(e,this.columns-r-1)}}]),n}(ht),Mr=function(o){W(n,o);var u=G(n);function n(t){return L(this,n),u.call(this,t,t.rows,t.columns)}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(this.rows-e-1,r,s),this}},{key:"get",value:function(e,r){return this.matrix.get(this.rows-e-1,r)}}]),n}(ht),Er=function(o){W(n,o);var u=G(n);function n(t,e){var r;return L(this,n),tt(t,e),r=u.call(this,t,1,t.columns),r.row=e,r}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(this.row,r,s),this}},{key:"get",value:function(e,r){return this.matrix.get(this.row,r)}}]),n}(ht),br=function(o){W(n,o);var u=G(n);function n(t,e){var r;return L(this,n),le(t,e),r=u.call(this,t,e.length,t.columns),r.rowIndices=e,r}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(this.rowIndices[e],r,s),this}},{key:"get",value:function(e,r){return this.matrix.get(this.rowIndices[e],r)}}]),n}(ht),re=function(o){W(n,o);var u=G(n);function n(t,e,r){var s;return L(this,n),le(t,e),ce(t,r),s=u.call(this,t,e.length,r.length),s.rowIndices=e,s.columnIndices=r,s}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(this.rowIndices[e],this.columnIndices[r],s),this}},{key:"get",value:function(e,r){return this.matrix.get(this.rowIndices[e],this.columnIndices[r])}}]),n}(ht),kr=function(o){W(n,o);var u=G(n);function n(t,e,r,s,i){var a;return L(this,n),ge(t,e,r,s,i),a=u.call(this,t,r-e+1,i-s+1),a.startRow=e,a.startColumn=s,a}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(this.startRow+e,this.startColumn+r,s),this}},{key:"get",value:function(e,r){return this.matrix.get(this.startRow+e,this.startColumn+r)}}]),n}(ht),Rr=function(o){W(n,o);var u=G(n);function n(t){return L(this,n),u.call(this,t,t.columns,t.rows)}return $(n,[{key:"set",value:function(e,r,s){return this.matrix.set(r,e,s),this}},{key:"get",value:function(e,r){return this.matrix.get(r,e)}}]),n}(ht),Be=function(o){W(n,o);var u=G(n);function n(t){var e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};L(this,n);var s=r.rows,i=s===void 0?1:s;if(t.length%i!==0)throw new Error("the data length is not divisible by the number of rows");return e=u.call(this),e.rows=i,e.columns=t.length/i,e.data=t,e}return $(n,[{key:"set",value:function(e,r,s){var i=this._calculateIndex(e,r);return this.data[i]=s,this}},{key:"get",value:function(e,r){var s=this._calculateIndex(e,r);return this.data[s]}},{key:"_calculateIndex",value:function(e,r){return e*this.columns+r}}]),n}(P),H=function(o){W(n,o);var u=G(n);function n(t){var e;return L(this,n),e=u.call(this),e.data=t,e.rows=t.length,e.columns=t[0].length,e}return $(n,[{key:"set",value:function(e,r,s){return this.data[e][r]=s,this}},{key:"get",value:function(e,r){return this.data[e][r]}}]),n}(P);function Nr(o,u){if(X.isAnyArray(o))return o[0]&&X.isAnyArray(o[0])?new H(o):new Be(o,u);throw new Error("the argument is not an array")}var ne=function(){function o(u){L(this,o),u=H.checkMatrix(u);var n=u.clone(),t=n.rows,e=n.columns,r=new Float64Array(t),s=1,i,a,h,f,v,c,w,g,d;for(i=0;i<t;i++)r[i]=i;for(g=new Float64Array(t),a=0;a<e;a++){for(i=0;i<t;i++)g[i]=n.get(i,a);for(i=0;i<t;i++){for(d=Math.min(i,a),v=0,h=0;h<d;h++)v+=n.get(i,h)*g[h];g[i]-=v,n.set(i,a,g[i])}for(f=a,i=a+1;i<t;i++)Math.abs(g[i])>Math.abs(g[f])&&(f=i);if(f!==a){for(h=0;h<e;h++)c=n.get(f,h),n.set(f,h,n.get(a,h)),n.set(a,h,c);w=r[f],r[f]=r[a],r[a]=w,s=-s}if(a<t&&n.get(a,a)!==0)for(i=a+1;i<t;i++)n.set(i,a,n.get(i,a)/n.get(a,a))}this.LU=n,this.pivotVector=r,this.pivotSign=s}return $(o,[{key:"isSingular",value:function(){for(var n=this.LU,t=n.columns,e=0;e<t;e++)if(n.get(e,e)===0)return!0;return!1}},{key:"solve",value:function(n){n=S.checkMatrix(n);var t=this.LU,e=t.rows;if(e!==n.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var r=n.columns,s=n.subMatrixRow(this.pivotVector,0,r-1),i=t.columns,a,h,f;for(f=0;f<i;f++)for(a=f+1;a<i;a++)for(h=0;h<r;h++)s.set(a,h,s.get(a,h)-s.get(f,h)*t.get(a,f));for(f=i-1;f>=0;f--){for(h=0;h<r;h++)s.set(f,h,s.get(f,h)/t.get(f,f));for(a=0;a<f;a++)for(h=0;h<r;h++)s.set(a,h,s.get(a,h)-s.get(f,h)*t.get(a,f))}return s}},{key:"determinant",get:function(){var n=this.LU;if(!n.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,e=n.columns,r=0;r<e;r++)t*=n.get(r,r);return t}},{key:"lowerTriangularMatrix",get:function(){for(var n=this.LU,t=n.rows,e=n.columns,r=new S(t,e),s=0;s<t;s++)for(var i=0;i<e;i++)s>i?r.set(s,i,n.get(s,i)):s===i?r.set(s,i,1):r.set(s,i,0);return r}},{key:"upperTriangularMatrix",get:function(){for(var n=this.LU,t=n.rows,e=n.columns,r=new S(t,e),s=0;s<t;s++)for(var i=0;i<e;i++)s<=i?r.set(s,i,n.get(s,i)):r.set(s,i,0);return r}},{key:"pivotPermutationVector",get:function(){return Array.from(this.pivotVector)}}]),o}();function ft(o,u){var n=0;return Math.abs(o)>Math.abs(u)?(n=u/o,Math.abs(o)*Math.sqrt(1+n*n)):u!==0?(n=o/u,Math.abs(u)*Math.sqrt(1+n*n)):0}var we=function(){function o(u){L(this,o),u=H.checkMatrix(u);var n=u.clone(),t=u.rows,e=u.columns,r=new Float64Array(e),s,i,a,h;for(a=0;a<e;a++){var f=0;for(s=a;s<t;s++)f=ft(f,n.get(s,a));if(f!==0){for(n.get(a,a)<0&&(f=-f),s=a;s<t;s++)n.set(s,a,n.get(s,a)/f);for(n.set(a,a,n.get(a,a)+1),i=a+1;i<e;i++){for(h=0,s=a;s<t;s++)h+=n.get(s,a)*n.get(s,i);for(h=-h/n.get(a,a),s=a;s<t;s++)n.set(s,i,n.get(s,i)+h*n.get(s,a))}}r[a]=-f}this.QR=n,this.Rdiag=r}return $(o,[{key:"solve",value:function(n){n=S.checkMatrix(n);var t=this.QR,e=t.rows;if(n.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r=n.columns,s=n.clone(),i=t.columns,a,h,f,v;for(f=0;f<i;f++)for(h=0;h<r;h++){for(v=0,a=f;a<e;a++)v+=t.get(a,f)*s.get(a,h);for(v=-v/t.get(f,f),a=f;a<e;a++)s.set(a,h,s.get(a,h)+v*t.get(a,f))}for(f=i-1;f>=0;f--){for(h=0;h<r;h++)s.set(f,h,s.get(f,h)/this.Rdiag[f]);for(a=0;a<f;a++)for(h=0;h<r;h++)s.set(a,h,s.get(a,h)-s.get(f,h)*t.get(a,f))}return s.subMatrix(0,i-1,0,r-1)}},{key:"isFullRank",value:function(){for(var n=this.QR.columns,t=0;t<n;t++)if(this.Rdiag[t]===0)return!1;return!0}},{key:"upperTriangularMatrix",get:function(){var n=this.QR,t=n.columns,e=new S(t,t),r,s;for(r=0;r<t;r++)for(s=0;s<t;s++)r<s?e.set(r,s,n.get(r,s)):r===s?e.set(r,s,this.Rdiag[r]):e.set(r,s,0);return e}},{key:"orthogonalMatrix",get:function(){var n=this.QR,t=n.rows,e=n.columns,r=new S(t,e),s,i,a,h;for(a=e-1;a>=0;a--){for(s=0;s<t;s++)r.set(s,a,0);for(r.set(a,a,1),i=a;i<e;i++)if(n.get(a,a)!==0){for(h=0,s=a;s<t;s++)h+=n.get(s,a)*r.get(s,i);for(h=-h/n.get(a,a),s=a;s<t;s++)r.set(s,i,r.get(s,i)+h*n.get(s,a))}}return r}}]),o}(),Vt=function(){function o(u){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(L(this,o),u=H.checkMatrix(u),u.isEmpty())throw new Error("Matrix must be non-empty");var t=u.rows,e=u.columns,r=n.computeLeftSingularVectors,s=r===void 0?!0:r,i=n.computeRightSingularVectors,a=i===void 0?!0:i,h=n.autoTranspose,f=h===void 0?!1:h,v=!!s,c=!!a,w=!1,g;if(t<e)if(!f)g=u.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{g=u.transpose(),t=g.rows,e=g.columns,w=!0;var d=v;v=c,c=d}else g=u.clone();for(var R=Math.min(t,e),l=Math.min(t+1,e),m=new Float64Array(l),p=new S(t,R),E=new S(e,e),y=new Float64Array(e),C=new Float64Array(t),F=new Float64Array(l),k=0;k<l;k++)F[k]=k;for(var N=Math.min(t-1,e),q=Math.max(0,Math.min(e-2,t)),Q=Math.max(N,q),M=0;M<Q;M++){if(M<N){m[M]=0;for(var A=M;A<t;A++)m[M]=ft(m[M],g.get(A,M));if(m[M]!==0){g.get(M,M)<0&&(m[M]=-m[M]);for(var Y=M;Y<t;Y++)g.set(Y,M,g.get(Y,M)/m[M]);g.set(M,M,g.get(M,M)+1)}m[M]=-m[M]}for(var D=M+1;D<e;D++){if(M<N&&m[M]!==0){for(var ct=0,gt=M;gt<t;gt++)ct+=g.get(gt,M)*g.get(gt,D);ct=-ct/g.get(M,M);for(var U=M;U<t;U++)g.set(U,D,g.get(U,D)+ct*g.get(U,M))}y[D]=g.get(M,D)}if(v&&M<N)for(var vt=M;vt<t;vt++)p.set(vt,M,g.get(vt,M));if(M<q){y[M]=0;for(var j=M+1;j<e;j++)y[M]=ft(y[M],y[j]);if(y[M]!==0){y[M+1]<0&&(y[M]=0-y[M]);for(var ut=M+1;ut<e;ut++)y[ut]/=y[M];y[M+1]+=1}if(y[M]=-y[M],M+1<t&&y[M]!==0){for(var O=M+1;O<t;O++)C[O]=0;for(var dt=M+1;dt<t;dt++)for(var St=M+1;St<e;St++)C[dt]+=y[St]*g.get(dt,St);for(var Mt=M+1;Mt<e;Mt++)for(var pe=-y[Mt]/y[M+1],Et=M+1;Et<t;Et++)g.set(Et,Mt,g.get(Et,Mt)+pe*C[Et])}if(c)for(var Dt=M+1;Dt<e;Dt++)E.set(Dt,M,y[Dt])}}var V=Math.min(e,t+1);if(N<e&&(m[N]=g.get(N,N)),t<V&&(m[V-1]=0),q+1<V&&(y[q]=g.get(q,V-1)),y[V-1]=0,v){for(var bt=N;bt<R;bt++){for(var Qt=0;Qt<t;Qt++)p.set(Qt,bt,0);p.set(bt,bt,1)}for(var z=N-1;z>=0;z--)if(m[z]!==0){for(var kt=z+1;kt<R;kt++){for(var qt=0,zt=z;zt<t;zt++)qt+=p.get(zt,z)*p.get(zt,kt);qt=-qt/p.get(z,z);for(var Rt=z;Rt<t;Rt++)p.set(Rt,kt,p.get(Rt,kt)+qt*p.get(Rt,z))}for(var Pt=z;Pt<t;Pt++)p.set(Pt,z,-p.get(Pt,z));p.set(z,z,1+p.get(z,z));for(var Yt=0;Yt<z-1;Yt++)p.set(Yt,z,0)}else{for(var ye=0;ye<t;ye++)p.set(ye,z,0);p.set(z,z,1)}}if(c)for(var x=e-1;x>=0;x--){if(x<q&&y[x]!==0)for(var Wt=x+1;Wt<e;Wt++){for(var ae=0,ie=x+1;ie<e;ie++)ae+=E.get(ie,x)*E.get(ie,Wt);ae=-ae/E.get(x+1,x);for(var Gt=x+1;Gt<e;Gt++)E.set(Gt,Wt,E.get(Gt,Wt)+ae*E.get(Gt,x))}for(var de=0;de<e;de++)E.set(de,x,0);E.set(x,x,1)}for(var We=V-1,Ge=Number.EPSILON;V>0;){var b=void 0,Jt=void 0;for(b=V-2;b>=-1&&b!==-1;b--){var Br=Number.MIN_VALUE+Ge*Math.abs(m[b]+Math.abs(m[b+1]));if(Math.abs(y[b])<=Br||Number.isNaN(y[b])){y[b]=0;break}}if(b===V-2)Jt=4;else{var _=void 0;for(_=V-1;_>=b&&_!==b;_--){var Ur=(_!==V?Math.abs(y[_]):0)+(_!==b+1?Math.abs(y[_-1]):0);if(Math.abs(m[_])<=Ge*Ur){m[_]=0;break}}_===b?Jt=3:_===V-1?Jt=1:(Jt=2,b=_)}switch(b++,Jt){case 1:{var Se=y[V-2];y[V-2]=0;for(var rt=V-2;rt>=b;rt--){var Kt=ft(m[rt],Se),Me=m[rt]/Kt,Ee=Se/Kt;if(m[rt]=Kt,rt!==b&&(Se=-Ee*y[rt-1],y[rt-1]=Me*y[rt-1]),c)for(var mt=0;mt<e;mt++)Kt=Me*E.get(mt,rt)+Ee*E.get(mt,V-1),E.set(mt,V-1,-Ee*E.get(mt,rt)+Me*E.get(mt,V-1)),E.set(mt,rt,Kt)}break}case 2:{var be=y[b-1];y[b-1]=0;for(var st=b;st<V;st++){var Xt=ft(m[st],be),ke=m[st]/Xt,Re=be/Xt;if(m[st]=Xt,be=-Re*y[st],y[st]=ke*y[st],v)for(var wt=0;wt<t;wt++)Xt=ke*p.get(wt,st)+Re*p.get(wt,b-1),p.set(wt,b-1,-Re*p.get(wt,st)+ke*p.get(wt,b-1)),p.set(wt,st,Xt)}break}case 3:{var Zt=Math.max(Math.abs(m[V-1]),Math.abs(m[V-2]),Math.abs(y[V-2]),Math.abs(m[b]),Math.abs(y[b])),Lt=m[V-1]/Zt,Je=m[V-2]/Zt,ue=y[V-2]/Zt,Ne=m[b]/Zt,Or=y[b]/Zt,Nt=((Je+Lt)*(Je-Lt)+ue*ue)/2,he=Lt*ue*(Lt*ue),At=0;(Nt!==0||he!==0)&&(Nt<0?At=0-Math.sqrt(Nt*Nt+he):At=Math.sqrt(Nt*Nt+he),At=he/(Nt+At));for(var It=(Ne+Lt)*(Ne-Lt)+At,$t=Ne*Or,T=b;T<V-1;T++){var J=ft(It,$t);J===0&&(J=Number.MIN_VALUE);var ot=It/J,at=$t/J;if(T!==b&&(y[T-1]=J),It=ot*m[T]+at*y[T],y[T]=ot*y[T]-at*m[T],$t=at*m[T+1],m[T+1]=ot*m[T+1],c)for(var pt=0;pt<e;pt++)J=ot*E.get(pt,T)+at*E.get(pt,T+1),E.set(pt,T+1,-at*E.get(pt,T)+ot*E.get(pt,T+1)),E.set(pt,T,J);if(J=ft(It,$t),J===0&&(J=Number.MIN_VALUE),ot=It/J,at=$t/J,m[T]=J,It=ot*y[T]+at*m[T+1],m[T+1]=-at*y[T]+ot*m[T+1],$t=at*y[T+1],y[T+1]=ot*y[T+1],v&&T<t-1)for(var yt=0;yt<t;yt++)J=ot*p.get(yt,T)+at*p.get(yt,T+1),p.set(yt,T+1,-at*p.get(yt,T)+ot*p.get(yt,T+1)),p.set(yt,T,J)}y[V-2]=It;break}case 4:{if(m[b]<=0&&(m[b]=m[b]<0?-m[b]:0,c))for(var fe=0;fe<=We;fe++)E.set(fe,b,-E.get(fe,b));for(;b<We&&!(m[b]>=m[b+1]);){var xt=m[b];if(m[b]=m[b+1],m[b+1]=xt,c&&b<e-1)for(var Bt=0;Bt<e;Bt++)xt=E.get(Bt,b+1),E.set(Bt,b+1,E.get(Bt,b)),E.set(Bt,b,xt);if(v&&b<t-1)for(var Ut=0;Ut<t;Ut++)xt=p.get(Ut,b+1),p.set(Ut,b+1,p.get(Ut,b)),p.set(Ut,b,xt);b++}V--;break}}}if(w){var Qr=E;E=p,p=Qr}this.m=t,this.n=e,this.s=m,this.U=p,this.V=E}return $(o,[{key:"solve",value:function(n){for(var t=n,e=this.threshold,r=this.s.length,s=S.zeros(r,r),i=0;i<r;i++)Math.abs(this.s[i])<=e?s.set(i,i,0):s.set(i,i,1/this.s[i]);for(var a=this.U,h=this.rightSingularVectors,f=h.mmul(s),v=h.rows,c=a.rows,w=S.zeros(v,c),g=0;g<v;g++)for(var d=0;d<c;d++){for(var R=0,l=0;l<r;l++)R+=f.get(g,l)*a.get(d,l);w.set(g,d,R)}return w.mmul(t)}},{key:"solveForDiagonal",value:function(n){return this.solve(S.diag(n))}},{key:"inverse",value:function(){for(var n=this.V,t=this.threshold,e=n.rows,r=n.columns,s=new S(e,this.s.length),i=0;i<e;i++)for(var a=0;a<r;a++)Math.abs(this.s[a])>t&&s.set(i,a,n.get(i,a)/this.s[a]);for(var h=this.U,f=h.rows,v=h.columns,c=new S(e,f),w=0;w<e;w++)for(var g=0;g<f;g++){for(var d=0,R=0;R<v;R++)d+=s.get(w,R)*h.get(g,R);c.set(w,g,d)}return c}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var n=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,e=this.s,r=0,s=e.length;r<s;r++)e[r]>n&&t++;return t}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return S.diag(this.s)}}]),o}();function Ir(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o=H.checkMatrix(o),u?new Vt(o).inverse():Ue(o,S.eye(o.rows))}function Ue(o,u){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return o=H.checkMatrix(o),u=H.checkMatrix(u),n?new Vt(o).solve(u):o.isSquare()?new ne(o).solve(u):new we(o).solve(u)}function se(o){if(o=S.checkMatrix(o),o.isSquare()){if(o.columns===0)return 1;var u,n,t,e;if(o.columns===2)return u=o.get(0,0),n=o.get(0,1),t=o.get(1,0),e=o.get(1,1),u*e-n*t;if(o.columns===3){var r,s,i;return r=new re(o,[1,2],[1,2]),s=new re(o,[1,2],[0,2]),i=new re(o,[1,2],[0,1]),u=o.get(0,0),n=o.get(0,1),t=o.get(0,2),u*se(r)-n*se(s)+t*se(i)}else return new ne(o).determinant}else throw Error("determinant can only be calculated for a square matrix")}function Tr(o,u){for(var n=[],t=0;t<o;t++)t!==u&&n.push(t);return n}function Cr(o,u,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e-9,e=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e-9;if(o>e)return new Array(u.rows+1).fill(0);for(var r=u.addRow(n,[0]),s=0;s<r.rows;s++)Math.abs(r.get(s,0))<t&&r.set(s,0,0);return r.to1DArray()}function Fr(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=u.thresholdValue,t=n===void 0?1e-9:n,e=u.thresholdError,r=e===void 0?1e-9:e;o=S.checkMatrix(o);for(var s=o.rows,i=new S(s,s),a=0;a<s;a++){var h=S.columnVector(o.getRow(a)),f=o.subMatrixRow(Tr(s,a)).transpose(),v=new Vt(f),c=v.solve(h),w=S.sub(h,f.mmul(c)).abs().max();i.setRow(a,Cr(w,c,a,t,r))}return i}function Vr(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.EPSILON;if(o=S.checkMatrix(o),o.isEmpty())return o.transpose();for(var n=new Vt(o,{autoTranspose:!0}),t=n.leftSingularVectors,e=n.rightSingularVectors,r=n.diagonal,s=0;s<r.length;s++)Math.abs(r[s])>u?r[s]=1/r[s]:r[s]=0;return e.mmul(S.diag(r).mmul(t.transpose()))}function Dr(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};o=new S(o);var t=!1;if(K(u)==="object"&&!S.isMatrix(u)&&!X.isAnyArray(u)?(n=u,u=o,t=!0):u=new S(u),o.rows!==u.rows)throw new TypeError("Both matrices must have the same number of rows");var e=n,r=e.center,s=r===void 0?!0:r;s&&(o=o.center("column"),t||(u=u.center("column")));for(var i=o.transpose().mmul(u),a=0;a<i.rows;a++)for(var h=0;h<i.columns;h++)i.set(a,h,i.get(a,h)*(1/(o.rows-1)));return i}function qr(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};o=new S(o);var t=!1;if(K(u)==="object"&&!S.isMatrix(u)&&!X.isAnyArray(u)?(n=u,u=o,t=!0):u=new S(u),o.rows!==u.rows)throw new TypeError("Both matrices must have the same number of rows");var e=n,r=e.center,s=r===void 0?!0:r,i=e.scale,a=i===void 0?!0:i;s&&(o.center("column"),t||u.center("column")),a&&(o.scale("column"),t||u.scale("column"));for(var h=o.standardDeviation("column",{unbiased:!0}),f=t?h:u.standardDeviation("column",{unbiased:!0}),v=o.transpose().mmul(u),c=0;c<v.rows;c++)for(var w=0;w<v.columns;w++)v.set(c,w,v.get(c,w)*(1/(h[c]*f[w]))*(1/(o.rows-1)));return v}var Oe=function(){function o(u){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};L(this,o);var t=n.assumeSymmetric,e=t===void 0?!1:t;if(u=H.checkMatrix(u),!u.isSquare())throw new Error("Matrix is not a square matrix");if(u.isEmpty())throw new Error("Matrix must be non-empty");var r=u.columns,s=new S(r,r),i=new Float64Array(r),a=new Float64Array(r),h=u,f,v,c=!1;if(e?c=!0:c=u.isSymmetric(),c){for(f=0;f<r;f++)for(v=0;v<r;v++)s.set(f,v,h.get(f,v));zr(r,a,i,s),Pr(r,a,i,s)}else{var w=new S(r,r),g=new Float64Array(r);for(v=0;v<r;v++)for(f=0;f<r;f++)w.set(f,v,h.get(f,v));Lr(r,w,g,s),$r(r,a,i,s,w)}this.n=r,this.e=a,this.d=i,this.V=s}return $(o,[{key:"realEigenvalues",get:function(){return Array.from(this.d)}},{key:"imaginaryEigenvalues",get:function(){return Array.from(this.e)}},{key:"eigenvectorMatrix",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){var n=this.n,t=this.e,e=this.d,r=new S(n,n),s,i;for(s=0;s<n;s++){for(i=0;i<n;i++)r.set(s,i,0);r.set(s,s,e[s]),t[s]>0?r.set(s,s+1,t[s]):t[s]<0&&r.set(s,s-1,t[s])}return r}}]),o}();function zr(o,u,n,t){var e,r,s,i,a,h,f,v;for(a=0;a<o;a++)n[a]=t.get(o-1,a);for(i=o-1;i>0;i--){for(v=0,s=0,h=0;h<i;h++)v=v+Math.abs(n[h]);if(v===0)for(u[i]=n[i-1],a=0;a<i;a++)n[a]=t.get(i-1,a),t.set(i,a,0),t.set(a,i,0);else{for(h=0;h<i;h++)n[h]/=v,s+=n[h]*n[h];for(e=n[i-1],r=Math.sqrt(s),e>0&&(r=-r),u[i]=v*r,s=s-e*r,n[i-1]=e-r,a=0;a<i;a++)u[a]=0;for(a=0;a<i;a++){for(e=n[a],t.set(a,i,e),r=u[a]+t.get(a,a)*e,h=a+1;h<=i-1;h++)r+=t.get(h,a)*n[h],u[h]+=t.get(h,a)*e;u[a]=r}for(e=0,a=0;a<i;a++)u[a]/=s,e+=u[a]*n[a];for(f=e/(s+s),a=0;a<i;a++)u[a]-=f*n[a];for(a=0;a<i;a++){for(e=n[a],r=u[a],h=a;h<=i-1;h++)t.set(h,a,t.get(h,a)-(e*u[h]+r*n[h]));n[a]=t.get(i-1,a),t.set(i,a,0)}}n[i]=s}for(i=0;i<o-1;i++){if(t.set(o-1,i,t.get(i,i)),t.set(i,i,1),s=n[i+1],s!==0){for(h=0;h<=i;h++)n[h]=t.get(h,i+1)/s;for(a=0;a<=i;a++){for(r=0,h=0;h<=i;h++)r+=t.get(h,i+1)*t.get(h,a);for(h=0;h<=i;h++)t.set(h,a,t.get(h,a)-r*n[h])}}for(h=0;h<=i;h++)t.set(h,i+1,0)}for(a=0;a<o;a++)n[a]=t.get(o-1,a),t.set(o-1,a,0);t.set(o-1,o-1,1),u[0]=0}function Pr(o,u,n,t){var e,r,s,i,a,h,f,v,c,w,g,d,R,l,m,p;for(s=1;s<o;s++)u[s-1]=u[s];u[o-1]=0;var E=0,y=0,C=Number.EPSILON;for(h=0;h<o;h++){for(y=Math.max(y,Math.abs(n[h])+Math.abs(u[h])),f=h;f<o&&!(Math.abs(u[f])<=C*y);)f++;if(f>h)do{for(e=n[h],v=(n[h+1]-e)/(2*u[h]),c=ft(v,1),v<0&&(c=-c),n[h]=u[h]/(v+c),n[h+1]=u[h]*(v+c),w=n[h+1],r=e-n[h],s=h+2;s<o;s++)n[s]-=r;for(E=E+r,v=n[f],g=1,d=g,R=g,l=u[h+1],m=0,p=0,s=f-1;s>=h;s--)for(R=d,d=g,p=m,e=g*u[s],r=g*v,c=ft(v,u[s]),u[s+1]=m*c,m=u[s]/c,g=v/c,v=g*n[s]-m*e,n[s+1]=r+m*(g*e+m*n[s]),a=0;a<o;a++)r=t.get(a,s+1),t.set(a,s+1,m*t.get(a,s)+g*r),t.set(a,s,g*t.get(a,s)-m*r);v=-m*p*R*l*u[h]/w,u[h]=m*v,n[h]=g*v}while(Math.abs(u[h])>C*y);n[h]=n[h]+E,u[h]=0}for(s=0;s<o-1;s++){for(a=s,v=n[s],i=s+1;i<o;i++)n[i]<v&&(a=i,v=n[i]);if(a!==s)for(n[a]=n[s],n[s]=v,i=0;i<o;i++)v=t.get(i,s),t.set(i,s,t.get(i,a)),t.set(i,a,v)}}function Lr(o,u,n,t){var e=0,r=o-1,s,i,a,h,f,v,c;for(v=e+1;v<=r-1;v++){for(c=0,h=v;h<=r;h++)c=c+Math.abs(u.get(h,v-1));if(c!==0){for(a=0,h=r;h>=v;h--)n[h]=u.get(h,v-1)/c,a+=n[h]*n[h];for(i=Math.sqrt(a),n[v]>0&&(i=-i),a=a-n[v]*i,n[v]=n[v]-i,f=v;f<o;f++){for(s=0,h=r;h>=v;h--)s+=n[h]*u.get(h,f);for(s=s/a,h=v;h<=r;h++)u.set(h,f,u.get(h,f)-s*n[h])}for(h=0;h<=r;h++){for(s=0,f=r;f>=v;f--)s+=n[f]*u.get(h,f);for(s=s/a,f=v;f<=r;f++)u.set(h,f,u.get(h,f)-s*n[f])}n[v]=c*n[v],u.set(v,v-1,c*i)}}for(h=0;h<o;h++)for(f=0;f<o;f++)t.set(h,f,h===f?1:0);for(v=r-1;v>=e+1;v--)if(u.get(v,v-1)!==0){for(h=v+1;h<=r;h++)n[h]=u.get(h,v-1);for(f=v;f<=r;f++){for(i=0,h=v;h<=r;h++)i+=n[h]*t.get(h,f);for(i=i/n[v]/u.get(v,v-1),h=v;h<=r;h++)t.set(h,f,t.get(h,f)+i*n[h])}}}function $r(o,u,n,t,e){var r=o-1,s=0,i=o-1,a=Number.EPSILON,h=0,f=0,v=0,c=0,w=0,g=0,d=0,R=0,l,m,p,E,y,C,F,k,N,q,Q,M,A,Y,D;for(l=0;l<o;l++)for((l<s||l>i)&&(n[l]=e.get(l,l),u[l]=0),m=Math.max(l-1,0);m<o;m++)f=f+Math.abs(e.get(l,m));for(;r>=s;){for(E=r;E>s&&(g=Math.abs(e.get(E-1,E-1))+Math.abs(e.get(E,E)),g===0&&(g=f),!(Math.abs(e.get(E,E-1))<a*g));)E--;if(E===r)e.set(r,r,e.get(r,r)+h),n[r]=e.get(r,r),u[r]=0,r--,R=0;else if(E===r-1){if(F=e.get(r,r-1)*e.get(r-1,r),v=(e.get(r-1,r-1)-e.get(r,r))/2,c=v*v+F,d=Math.sqrt(Math.abs(c)),e.set(r,r,e.get(r,r)+h),e.set(r-1,r-1,e.get(r-1,r-1)+h),k=e.get(r,r),c>=0){for(d=v>=0?v+d:v-d,n[r-1]=k+d,n[r]=n[r-1],d!==0&&(n[r]=k-F/d),u[r-1]=0,u[r]=0,k=e.get(r,r-1),g=Math.abs(k)+Math.abs(d),v=k/g,c=d/g,w=Math.sqrt(v*v+c*c),v=v/w,c=c/w,m=r-1;m<o;m++)d=e.get(r-1,m),e.set(r-1,m,c*d+v*e.get(r,m)),e.set(r,m,c*e.get(r,m)-v*d);for(l=0;l<=r;l++)d=e.get(l,r-1),e.set(l,r-1,c*d+v*e.get(l,r)),e.set(l,r,c*e.get(l,r)-v*d);for(l=s;l<=i;l++)d=t.get(l,r-1),t.set(l,r-1,c*d+v*t.get(l,r)),t.set(l,r,c*t.get(l,r)-v*d)}else n[r-1]=k+v,n[r]=k+v,u[r-1]=d,u[r]=-d;r=r-2,R=0}else{if(k=e.get(r,r),N=0,F=0,E<r&&(N=e.get(r-1,r-1),F=e.get(r,r-1)*e.get(r-1,r)),R===10){for(h+=k,l=s;l<=r;l++)e.set(l,l,e.get(l,l)-k);g=Math.abs(e.get(r,r-1))+Math.abs(e.get(r-1,r-2)),k=N=.75*g,F=-.4375*g*g}if(R===30&&(g=(N-k)/2,g=g*g+F,g>0)){for(g=Math.sqrt(g),N<k&&(g=-g),g=k-F/((N-k)/2+g),l=s;l<=r;l++)e.set(l,l,e.get(l,l)-g);h+=g,k=N=F=.964}for(R=R+1,y=r-2;y>=E&&(d=e.get(y,y),w=k-d,g=N-d,v=(w*g-F)/e.get(y+1,y)+e.get(y,y+1),c=e.get(y+1,y+1)-d-w-g,w=e.get(y+2,y+1),g=Math.abs(v)+Math.abs(c)+Math.abs(w),v=v/g,c=c/g,w=w/g,!(y===E||Math.abs(e.get(y,y-1))*(Math.abs(c)+Math.abs(w))<a*(Math.abs(v)*(Math.abs(e.get(y-1,y-1))+Math.abs(d)+Math.abs(e.get(y+1,y+1))))));)y--;for(l=y+2;l<=r;l++)e.set(l,l-2,0),l>y+2&&e.set(l,l-3,0);for(p=y;p<=r-1&&(Y=p!==r-1,p!==y&&(v=e.get(p,p-1),c=e.get(p+1,p-1),w=Y?e.get(p+2,p-1):0,k=Math.abs(v)+Math.abs(c)+Math.abs(w),k!==0&&(v=v/k,c=c/k,w=w/k)),k!==0);p++)if(g=Math.sqrt(v*v+c*c+w*w),v<0&&(g=-g),g!==0){for(p!==y?e.set(p,p-1,-g*k):E!==y&&e.set(p,p-1,-e.get(p,p-1)),v=v+g,k=v/g,N=c/g,d=w/g,c=c/v,w=w/v,m=p;m<o;m++)v=e.get(p,m)+c*e.get(p+1,m),Y&&(v=v+w*e.get(p+2,m),e.set(p+2,m,e.get(p+2,m)-v*d)),e.set(p,m,e.get(p,m)-v*k),e.set(p+1,m,e.get(p+1,m)-v*N);for(l=0;l<=Math.min(r,p+3);l++)v=k*e.get(l,p)+N*e.get(l,p+1),Y&&(v=v+d*e.get(l,p+2),e.set(l,p+2,e.get(l,p+2)-v*w)),e.set(l,p,e.get(l,p)-v),e.set(l,p+1,e.get(l,p+1)-v*c);for(l=s;l<=i;l++)v=k*t.get(l,p)+N*t.get(l,p+1),Y&&(v=v+d*t.get(l,p+2),t.set(l,p+2,t.get(l,p+2)-v*w)),t.set(l,p,t.get(l,p)-v),t.set(l,p+1,t.get(l,p+1)-v*c)}}}if(f!==0){for(r=o-1;r>=0;r--)if(v=n[r],c=u[r],c===0)for(E=r,e.set(r,r,1),l=r-1;l>=0;l--){for(F=e.get(l,l)-v,w=0,m=E;m<=r;m++)w=w+e.get(l,m)*e.get(m,r);if(u[l]<0)d=F,g=w;else if(E=l,u[l]===0?e.set(l,r,F!==0?-w/F:-w/(a*f)):(k=e.get(l,l+1),N=e.get(l+1,l),c=(n[l]-v)*(n[l]-v)+u[l]*u[l],C=(k*g-d*w)/c,e.set(l,r,C),e.set(l+1,r,Math.abs(k)>Math.abs(d)?(-w-F*C)/k:(-g-N*C)/d)),C=Math.abs(e.get(l,r)),a*C*C>1)for(m=l;m<=r;m++)e.set(m,r,e.get(m,r)/C)}else if(c<0)for(E=r-1,Math.abs(e.get(r,r-1))>Math.abs(e.get(r-1,r))?(e.set(r-1,r-1,c/e.get(r,r-1)),e.set(r-1,r,-(e.get(r,r)-v)/e.get(r,r-1))):(D=oe(0,-e.get(r-1,r),e.get(r-1,r-1)-v,c),e.set(r-1,r-1,D[0]),e.set(r-1,r,D[1])),e.set(r,r-1,0),e.set(r,r,1),l=r-2;l>=0;l--){for(q=0,Q=0,m=E;m<=r;m++)q=q+e.get(l,m)*e.get(m,r-1),Q=Q+e.get(l,m)*e.get(m,r);if(F=e.get(l,l)-v,u[l]<0)d=F,w=q,g=Q;else if(E=l,u[l]===0?(D=oe(-q,-Q,F,c),e.set(l,r-1,D[0]),e.set(l,r,D[1])):(k=e.get(l,l+1),N=e.get(l+1,l),M=(n[l]-v)*(n[l]-v)+u[l]*u[l]-c*c,A=(n[l]-v)*2*c,M===0&&A===0&&(M=a*f*(Math.abs(F)+Math.abs(c)+Math.abs(k)+Math.abs(N)+Math.abs(d))),D=oe(k*w-d*q+c*Q,k*g-d*Q-c*q,M,A),e.set(l,r-1,D[0]),e.set(l,r,D[1]),Math.abs(k)>Math.abs(d)+Math.abs(c)?(e.set(l+1,r-1,(-q-F*e.get(l,r-1)+c*e.get(l,r))/k),e.set(l+1,r,(-Q-F*e.get(l,r)-c*e.get(l,r-1))/k)):(D=oe(-w-N*e.get(l,r-1),-g-N*e.get(l,r),d,c),e.set(l+1,r-1,D[0]),e.set(l+1,r,D[1]))),C=Math.max(Math.abs(e.get(l,r-1)),Math.abs(e.get(l,r))),a*C*C>1)for(m=l;m<=r;m++)e.set(m,r-1,e.get(m,r-1)/C),e.set(m,r,e.get(m,r)/C)}for(l=0;l<o;l++)if(l<s||l>i)for(m=l;m<o;m++)t.set(l,m,e.get(l,m));for(m=o-1;m>=s;m--)for(l=s;l<=i;l++){for(d=0,p=s;p<=Math.min(m,i);p++)d=d+t.get(l,p)*e.get(p,m);t.set(l,m,d)}}}function oe(o,u,n,t){var e,r;return Math.abs(n)>Math.abs(t)?(e=t/n,r=n+e*t,[(o+e*u)/r,(u-e*o)/r]):(e=n/t,r=t+e*n,[(e*o+u)/r,(e*u-o)/r])}var Qe=function(){function o(u){if(L(this,o),u=H.checkMatrix(u),!u.isSymmetric())throw new Error("Matrix is not symmetric");var n=u,t=n.rows,e=new S(t,t),r=!0,s,i,a;for(i=0;i<t;i++){var h=0;for(a=0;a<i;a++){var f=0;for(s=0;s<a;s++)f+=e.get(a,s)*e.get(i,s);f=(n.get(i,a)-f)/e.get(a,a),e.set(i,a,f),h=h+f*f}for(h=n.get(i,i)-h,r&&(r=h>0),e.set(i,i,Math.sqrt(Math.max(h,0))),a=i+1;a<t;a++)e.set(i,a,0)}this.L=e,this.positiveDefinite=r}return $(o,[{key:"isPositiveDefinite",value:function(){return this.positiveDefinite}},{key:"solve",value:function(n){n=H.checkMatrix(n);var t=this.L,e=t.rows;if(n.rows!==e)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");var r=n.columns,s=n.clone(),i,a,h;for(h=0;h<e;h++)for(a=0;a<r;a++){for(i=0;i<h;i++)s.set(h,a,s.get(h,a)-s.get(i,a)*t.get(h,i));s.set(h,a,s.get(h,a)/t.get(h,h))}for(h=e-1;h>=0;h--)for(a=0;a<r;a++){for(i=h+1;i<e;i++)s.set(h,a,s.get(h,a)-s.get(i,a)*t.get(i,h));s.set(h,a,s.get(h,a)/t.get(h,h))}return s}},{key:"lowerTriangularMatrix",get:function(){return this.L}}]),o}(),Ye=$(function o(u){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};L(this,o),u=H.checkMatrix(u);var t=n.Y,e=n.scaleScores,r=e===void 0?!1:e,s=n.maxIterations,i=s===void 0?1e3:s,a=n.terminationCriteria,h=a===void 0?1e-10:a,f;if(t){if(X.isAnyArray(t)&&typeof t[0]=="number"?t=S.columnVector(t):t=H.checkMatrix(t),t.rows!==u.rows)throw new Error("Y should have the same number of rows as X");f=t.getColumnVector(0)}else f=u.getColumnVector(0);for(var v=1,c,w,g,d,R=0;R<i&&v>h;R++)g=u.transpose().mmul(f).div(f.transpose().mmul(f).get(0,0)),g=g.div(g.norm()),c=u.mmul(g).div(g.transpose().mmul(g).get(0,0)),R>0&&(v=c.clone().sub(d).pow(2).sum()),d=c.clone(),t?(w=t.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0)),w=w.div(w.norm()),f=t.mmul(w).div(w.transpose().mmul(w).get(0,0))):f=c;if(t){var l=u.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0));l=l.div(l.norm());var m=u.clone().sub(c.clone().mmul(l.transpose())),p=f.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0)),E=t.clone().sub(c.clone().mulS(p.get(0,0)).mmul(w.transpose()));this.t=c,this.p=l.transpose(),this.w=g.transpose(),this.q=w,this.u=f,this.s=c.transpose().mmul(c),this.xResidual=m,this.yResidual=E,this.betas=p}else this.w=g.transpose(),this.s=c.transpose().mmul(c).sqrt(),r?this.t=c.clone().div(this.s.get(0,0)):this.t=c,this.xResidual=u.sub(c.mmul(g.transpose()))});I.XA=P,I.a_=Qe,I.yQ=Qe,I.Hs=$e,I.Ec=Oe,I.dx=Oe,I.LU=ne,I.Rm=ne,I.y3=S,I.qK=dr,I.pb=yr,I.j=Sr,I.sO=Mr,I.BZ=br,I.EK=Er,I.Db=re,I.Fx=kr,I.tU=Rr,I.Ym=Ye,I.rs=Ye,I.QR=we,I.TB=we,I.oH=Vt,I.Sc=Vt,I.BN=Ot,I.it=Be,I.$r=H,I.QM=qr,I.AV=Dr,Ie=S,I.GH=se,I.SO=Ir,I.uZ=Fr,I.yU=Vr,I.F1=Ue,I.re=Nr}}]);
